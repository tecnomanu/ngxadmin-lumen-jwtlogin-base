<div class="row">
  <div class="col-md-12 col-table">
    <nb-card [nbSpinner]="loadingData" nbSpinnerSize="large" nbSpinnerStatus="success">
      <nb-card-header>
        <span>Usuarios</span>
        <span class="float-right" *nbIsGranted="['create', 'users']">
          <button class="btn btn-success btn-sm" routerLink="../create"><i class="ion-plus"></i> Nuevo</button>
        </span>
      </nb-card-header>
      <nb-card-body>
        <search-box (onChangeValue)="getPage(1, $event)" (onOptionChange)="refreshPage($event)" [baConfPage]="options" [show]="{export : false}"></search-box>
        <div class="table-container mt-2">
        <table class="table table-striped">
          <thead>
            <tr class="no-top-border">
              <th style="width: 100px;">Acci√≥n</th>
              <th style="width: 200px;">Nombre completo</th>
              <th>Usuario</th>
              <th>Rol</th>
              <th>Provider</th>
              <th>Email</th>
              <th>Nacimiento</th>
            </tr>
          </thead>
          <tbody *ngIf="asyncDataTable">
            <tr *ngFor="let user of asyncDataTable | async | paginate: config" class="no-top-border">
              <td>
                <span class="btn-inline" *ngIf="user.role != 'root' || (user.role == 'root' && userService.user.role == 'root')">
                  <button class="btn btn-success" *nbIsGranted="['edit', 'users']"
                          type="button"
                          (click)="editItem(user._id)">
                    <i class="ion-edit"></i>
                  </button>
                  <button class="btn btn-danger" *nbIsGranted="['remove', 'users']"
                          type="button"
                          (click)="deleteModal.show(user._id)">
                    <i class="ion-android-close"></i>
                  </button>
                </span>
              </td>
              <td class="nowrap">{{user.first_name}} {{user.last_name}}</td>
              <td class="nowrap">{{user.username}}</td>
              <th>{{user.role_name}}</th>
              <th>{{user.role == 'provider' || user.role == 'userProvider' ? user.provider.text : '-'}}</th>
              <td class="align-left">{{user.email}}</td>
              <td class="align-left"> {{user.birthday ? (user.birthday | date:"dd-MM-yyyy" ) : '-'}}</td>
            </tr>
          </tbody>
        </table>
      </div>
      </nb-card-body>
    </nb-card>
    <div class="text-center">
      <pagination-component [config]="config" (pageChange)="getPage($event)"></pagination-component>
      <!--<pagination-controls (pageChange)="getPage($event)" id="table"></pagination-controls>-->
    </div>
  </div>
</div>

<custom-modal #deleteModal [baModalConfig]="{title:'Eliminar Usuario',body:'Esta seguro que desea eliminar este elemento?', buttonOkey: 'Eliminar', buttonOkeyColor: 'btn-danger', buttonOkeyIcon : 'ion-trash-a'}" [disabled]="deleting" (onOkey)="deleteItem($event)"></custom-modal>